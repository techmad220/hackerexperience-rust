<!-- Authenticated User Interface -->
<div class="game-interface" id="game-interface">
    <!-- Top Navigation Bar -->
    <nav class="top-navbar">
        <div class="navbar-left">
            <div class="server-info">
                <span class="server-icon">üñ•Ô∏è</span>
                <div class="server-details">
                    <span class="server-name" id="current-server-name">{{current_server.name|default:'LocalHost'}}</span>
                    <span class="server-ip" id="current-server-ip">{{current_server.ip|default:'127.0.0.1'}}</span>
                </div>
            </div>
            <div class="connection-chain" id="connection-chain">
                <!-- Connection path will be displayed here -->
            </div>
        </div>
        
        <div class="navbar-center">
            <div class="quick-actions">
                <button class="quick-action-btn" id="scan-network-btn" title="Scan Network" data-action="scan_network">
                    <i class="fas fa-search"></i>
                </button>
                <button class="quick-action-btn" id="processes-btn" title="View Processes" data-action="view_processes">
                    <i class="fas fa-tasks"></i>
                    <span class="process-count" id="active-processes-count">{{active_processes_count|default:0}}</span>
                </button>
                <button class="quick-action-btn" id="notifications-btn" title="Notifications" data-action="toggle_notifications">
                    <i class="fas fa-bell"></i>
                    <span class="notification-count" id="notification-count" style="display: none;">0</span>
                </button>
            </div>
        </div>
        
        <div class="navbar-right">
            <div class="player-info">
                <div class="player-stats">
                    <div class="stat-item">
                        <i class="fas fa-dollar-sign"></i>
                        <span class="stat-value" id="player-money">${{user.money|floatformat:2}}</span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-bitcoin"></i>
                        <span class="stat-value" id="player-crypto">‚Çø{{user.crypto|floatformat:4}}</span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-star"></i>
                        <span class="stat-value" id="player-level">{{user.level}}</span>
                    </div>
                </div>
                
                <div class="player-profile">
                    <div class="player-avatar">
                        <img src="{{user.avatar_url|default:'/assets/images/default-avatar.png'}}" alt="{{user.username}}" class="avatar-img">
                        {% if user.online_status %}
                        <span class="status-indicator status-online"></span>
                        {% endif %}
                    </div>
                    <div class="player-details">
                        <span class="username">{{user.username}}</span>
                        <span class="user-title">{{user.title|default:'Novice Hacker'}}</span>
                    </div>
                    <div class="dropdown player-dropdown">
                        <button class="dropdown-toggle" type="button" id="player-menu" data-bs-toggle="dropdown">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#" data-page="profile"><i class="fas fa-user"></i> Profile</a></li>
                            <li><a class="dropdown-item" href="#" data-page="settings"><i class="fas fa-cog"></i> Settings</a></li>
                            <li><a class="dropdown-item" href="#" data-page="achievements"><i class="fas fa-trophy"></i> Achievements</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" id="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h3 class="sidebar-title">System</h3>
                <button class="sidebar-toggle" id="sidebar-toggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <nav class="sidebar-nav">
                <!-- System Section -->
                <div class="nav-section">
                    <h4 class="nav-section-title">
                        <i class="fas fa-desktop"></i>
                        System
                    </h4>
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a href="#" class="nav-link active" data-page="desktop">
                                <i class="fas fa-home"></i>
                                <span>Desktop</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="processes">
                                <i class="fas fa-tasks"></i>
                                <span>Processes</span>
                                <span class="nav-badge" id="processes-badge">{{active_processes_count|default:0}}</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="software">
                                <i class="fas fa-code"></i>
                                <span>Software</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="hardware">
                                <i class="fas fa-microchip"></i>
                                <span>Hardware</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="logs">
                                <i class="fas fa-list-alt"></i>
                                <span>Logs</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="filesystem">
                                <i class="fas fa-folder"></i>
                                <span>File System</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Network Section -->
                <div class="nav-section">
                    <h4 class="nav-section-title">
                        <i class="fas fa-globe"></i>
                        Network
                    </h4>
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="internet">
                                <i class="fas fa-globe-americas"></i>
                                <span>Internet</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="my-servers">
                                <i class="fas fa-server"></i>
                                <span>My Servers</span>
                                <span class="nav-badge">{{user_servers_count|default:1}}</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="connections">
                                <i class="fas fa-project-diagram"></i>
                                <span>Connections</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="tunnels">
                                <i class="fas fa-route"></i>
                                <span>Tunnels</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Financial Section -->
                <div class="nav-section">
                    <h4 class="nav-section-title">
                        <i class="fas fa-dollar-sign"></i>
                        Financial
                    </h4>
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="banking">
                                <i class="fas fa-university"></i>
                                <span>Banking</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="crypto">
                                <i class="fab fa-bitcoin"></i>
                                <span>Cryptocurrency</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="market">
                                <i class="fas fa-shopping-cart"></i>
                                <span>Market</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="transactions">
                                <i class="fas fa-receipt"></i>
                                <span>Transactions</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Social Section -->
                <div class="nav-section">
                    <h4 class="nav-section-title">
                        <i class="fas fa-users"></i>
                        Social
                    </h4>
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="clan">
                                <i class="fas fa-users-cog"></i>
                                <span>Clan</span>
                                {% if user.clan_id %}
                                <span class="clan-status online"></span>
                                {% endif %}
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="missions">
                                <i class="fas fa-bullseye"></i>
                                <span>Missions</span>
                                {% if available_missions_count > 0 %}
                                <span class="nav-badge">{{available_missions_count}}</span>
                                {% endif %}
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="ranking">
                                <i class="fas fa-trophy"></i>
                                <span>Ranking</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="mail">
                                <i class="fas fa-envelope"></i>
                                <span>Mail</span>
                                {% if unread_messages_count > 0 %}
                                <span class="nav-badge">{{unread_messages_count}}</span>
                                {% endif %}
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="chat">
                                <i class="fas fa-comments"></i>
                                <span>Chat</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Game Information -->
                <div class="nav-section">
                    <h4 class="nav-section-title">
                        <i class="fas fa-info-circle"></i>
                        Information
                    </h4>
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="statistics">
                                <i class="fas fa-chart-bar"></i>
                                <span>Statistics</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="news">
                                <i class="fas fa-newspaper"></i>
                                <span>News</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="help">
                                <i class="fas fa-question-circle"></i>
                                <span>Help</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- Sidebar Footer -->
            <div class="sidebar-footer">
                <div class="server-status">
                    <div class="status-indicator status-{{server_status|default:'online'}}"></div>
                    <span class="status-text">{{server_status_text|default:'Online'}}</span>
                </div>
                <div class="version-info">
                    <small>v{{game_version|default:'2.0.0'}}</small>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="content-area" id="content-area">
            <!-- Page Content Container -->
            <div class="page-container" id="page-container">
                <!-- Dynamic page content will be loaded here -->
                {% block page_content %}
                    {% include 'pages/desktop.html' %}
                {% endblock %}
            </div>
        </main>

        <!-- Right Panel (Optional) -->
        <aside class="right-panel" id="right-panel" style="display: none;">
            <div class="panel-header">
                <h4 class="panel-title" id="right-panel-title">Panel</h4>
                <button class="panel-close" id="right-panel-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="panel-content" id="right-panel-content">
                <!-- Dynamic panel content -->
            </div>
        </aside>
    </div>

    <!-- Bottom Status Bar -->
    <footer class="status-bar">
        <div class="status-left">
            <div class="status-item">
                <i class="fas fa-wifi"></i>
                <span class="connection-status" id="connection-status">Connected</span>
            </div>
            <div class="status-item">
                <i class="fas fa-tasks"></i>
                <span>Processes: <span id="active-process-count">{{active_processes_count|default:0}}</span></span>
            </div>
            <div class="status-item">
                <i class="fas fa-memory"></i>
                <span>Memory: <span id="memory-usage">{{memory_usage|default:0}}%</span></span>
            </div>
            <div class="status-item">
                <i class="fas fa-microchip"></i>
                <span>CPU: <span id="cpu-usage">{{cpu_usage|default:0}}%</span></span>
            </div>
        </div>
        
        <div class="status-center">
            <div class="current-action" id="current-action" style="display: none;">
                <i class="fas fa-spinner fa-spin"></i>
                <span class="action-text">Processing...</span>
            </div>
        </div>
        
        <div class="status-right">
            <div class="status-item">
                <i class="fas fa-users"></i>
                <span id="online-users-count">{{online_users_count|default:0}}</span> online
            </div>
            <div class="status-item">
                <i class="fas fa-clock"></i>
                <span class="current-time" id="current-time">{{current_time}}</span>
            </div>
            <div class="status-item">
                <button class="status-toggle" id="fullscreen-toggle" title="Toggle Fullscreen">
                    <i class="fas fa-expand"></i>
                </button>
            </div>
        </div>
    </footer>
</div>

<!-- Floating Action Button (Mobile) -->
<div class="fab-container" id="fab-container">
    <button class="fab fab-main" id="fab-main">
        <i class="fas fa-plus"></i>
    </button>
    <div class="fab-options" id="fab-options">
        <button class="fab fab-option" data-action="quick_hack" title="Quick Hack">
            <i class="fas fa-bolt"></i>
        </button>
        <button class="fab fab-option" data-action="scan_network" title="Scan Network">
            <i class="fas fa-search"></i>
        </button>
        <button class="fab fab-option" data-action="new_process" title="New Process">
            <i class="fas fa-play"></i>
        </button>
        <button class="fab fab-option" data-action="quick_transfer" title="Quick Transfer">
            <i class="fas fa-exchange-alt"></i>
        </button>
    </div>
</div>

<!-- Live Activity Feed (Optional Widget) -->
<div class="activity-feed" id="activity-feed" style="display: none;">
    <div class="feed-header">
        <h5>Live Activity</h5>
        <button class="feed-close">
            <i class="fas fa-times"></i>
        </button>
    </div>
    <div class="feed-content" id="activity-feed-content">
        <!-- Live activity items will appear here -->
    </div>
</div>

<!-- Process Monitor Widget -->
<div class="process-monitor-widget" id="process-monitor" style="display: none;">
    <div class="widget-header">
        <h6>Active Processes</h6>
        <button class="widget-minimize">
            <i class="fas fa-minus"></i>
        </button>
    </div>
    <div class="widget-content">
        <div class="process-list-compact" id="compact-process-list">
            <!-- Compact process list -->
        </div>
    </div>
</div>